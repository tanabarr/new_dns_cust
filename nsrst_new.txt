::GOTO END1					::stub out rest of the file for testing
:Start						::label "Start"
tasklist > tl1.txt				::read current tasklist into temporary text file
find /C "natspeak.exe" tl1.txt			::try to find relevant application in list of running tasks
IF ERRORLEVEL==1 GOTO END    			::if application not found go to label "END" and start application
taskkill /F /FI "STATUS ne RUNNING" /FI "MEMUSAGE gt 210000" /IM natspeak.exe > nsrst_dbg.log	
						::filter tasklist to contain only nonrunning or those using >210MB mem
						::if application image name (/IM) is running, forcefully kill it (/F) 
						::and output to debug log file
IF ERRORLEVEL!=0 GOTO END1
:Start1
TYPE NUL | choice /c:delay /td,3 >NUL		::complicated way of implementing a simple three second delay
tasklist > tl1.txt				::test application list again, to see if application closed yet
find /C "natspeak.exe" tl1.txt
IF ERRORLEVEL==1 GOTO END    			::if application name not found in tasklist, skip to "END" label
GOTO Start1					::application still in tasklist, skip to "Start1" label and try again
:END
start /B natspeak.exe				::application no longer running, restart it
:END1
SET Now=%Time: =0%				:: scheduling of this script in 12 minutes time
SET Hours=%Now:~0,2%
SET Minutes=%Now:~3,2%
SET /A Minutes += 12
SET /A Hours += %Minutes% / 60
SET /A Minutes = %Minutes% %% 60
at %Hours%:%Minutes% /INTERACTIVE ""C:\Program Files\Nuance\NaturallySpeaking10\Program\nsrst_new.bat""
:QUIT
pause
::FOR /F "tokens=1,2 delims=:." %%A IN ("%Time%") DO
::    SET /A %%B= 10 + %%B
::    SET /A Minutes = 100%%B %% 100
::)

